<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Character encoding -->
    <meta charset="UTF-8">

    <!-- Responsive scaling -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Page title -->
    <title>Heat Click with OE</title>

    <style>
        /* -------------------- GLOBAL RESET -------------------- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Arial", sans-serif;
        }

        /* -------------------- PAGE BACKGROUND -------------------- */
        body {
            background-color: #f6f7fb;
            display: flex;
            justify-content: center;
            padding: 50px 20px;
        }

        /* -------------------- OPEN MODULE BUTTON -------------------- */
        #openModuleBtn {
            padding: 14px 40px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            background: #1a237e;
            color: #fff;
            cursor: pointer;
            transition: 0.3s;
        }

        #openModuleBtn:hover {
            background: #3949ab;
        }

        /* -------------------- MAIN MODULE CONTAINER -------------------- */
        .dcm-wrapper {
            display: none;
            /* Hidden initially */
            width: 700px;
            height: 610px;
            background: #fff;
            padding: 30px 40px 80px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* -------------------- CLOSE BUTTON -------------------- */
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: none;
            background: #ffffff;
            color: #000000;
            font-size: 20px;
            cursor: pointer;
        }

        .close-btn:hover {
            background: #1a237e;
            color: #fff;
        }

        /* -------------------- HEADER -------------------- */
        .dcm-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo span {
            font-size: 20px;
            font-weight: bold;
            color: #0f0d94;
        }

        /* Divider line */
        .header-divider {
            margin-bottom: 30px;
            border: none;
            height: 1px;
            background: #ddd;
        }

        /* -------------------- QUESTION TEXT -------------------- */
        .question {
            text-align: center;
            font-size: 15px;
            margin-bottom: 20px;
            color: #1a237e;
        }

        /* -------------------- IMAGE WRAPPER -------------------- */
        .image-wrapper {
            position: relative;
            /* Needed for absolute dots & popup */
        }

        .image-wrapper img {
            width: 600px;
            height: 400px;
            border-radius: 10px;
            cursor: crosshair;
        }

        /* -------------------- CONTINUE BUTTON -------------------- */
        #continueBtn {
            position: absolute;
            right: 30px;
            bottom: 25px;
            padding: 12px 35px;
            border-radius: 30px;
            border: none;
            background: #1a237e;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
        }

        #continueBtn:hover {
            background: #3949ab;
        }

        /* -------------------- HEAT POPUP -------------------- */
        .heat-popup {
            position: absolute;
            width: 220px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
            padding: 12px;
            display: none;
            /* Hidden until image click */
            z-index: 1000;
        }

        .popup-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        /* Emoji row */
        .emoji-row {
            display: flex;
            justify-content: space-between;
            font-size: 22px;
            margin-bottom: 8px;
            cursor: pointer;
        }

        /* Default emoji faded */
        .emoji-row span {
            opacity: 0.5;
        }

        /* Active emoji */
        .emoji-row span.active {
            opacity: 1;
        }

        /* Comment box */
        .heat-popup textarea {
            width: 100%;
            height: 50px;
            resize: none;
            margin-bottom: 8px;
        }

        /* Popup buttons */
        .popup-actions {
            display: flex;
            justify-content: space-around;
        }

        .popup-actions button {
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }

        /* -------------------- HEAT DOT -------------------- */
        .heat-dot {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            pointer-events: none;
            /* Prevent interaction */
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>

    <!-- Button to open the module -->
    <button id="openModuleBtn">15 sports picnic</button>

    <!-- Main module -->
    <div class="dcm-wrapper" id="dcmModule">

        <!-- Close button -->
        <button class="close-btn" id="closeModuleBtn">√ó</button>

        <!-- Header -->
        <div class="dcm-header">
            <div class="logo">
                <span>Heat Click with OE</span>
            </div>
        </div>

        <hr class="header-divider">

        <!-- Question -->
        <h2 class="question">
            Please click up to 15 spots to describe how you feel about the following picnic layout.
        </h2>

        <!-- Image container -->
        <div class="image-wrapper">
            <img id="heatImage" src="Heat Click With Oe.jpg" alt="Picnic layout">
        </div>

        <!-- Popup shown on image click -->
        <div id="heatPopup" class="heat-popup">

            <div class="popup-title">How does this feel?</div>

            <!-- Emoji selection -->
            <div class="emoji-row">
                <span data-feel="happy">üòä</span>
                <span data-feel="neutral">üòê</span>
                <span data-feel="sad">‚òπÔ∏è</span>
            </div>

            <!-- Comment box -->
            <textarea placeholder="Please explain why"></textarea>

            <!-- Popup actions -->
            <div class="popup-actions">
                <button id="submitHeat">Submit</button>
                <button id="cancelHeat">Cancel</button>
            </div>
        </div>

        <!-- Continue button -->
        <button id="continueBtn">Continue ¬ª</button>
    </div>

    <!-- -------------------- MODULE OPEN / CLOSE SCRIPT -------------------- -->
    <script>
        const openBtn = document.getElementById("openModuleBtn");
        const closeBtn = document.getElementById("closeModuleBtn");
        const continueBtn = document.getElementById("continueBtn");
        const module = document.getElementById("dcmModule");

        // Open module
        openBtn.addEventListener("click", () => {
            module.style.display = "block";
            openBtn.style.display = "none";
        });

        // Close module (used by close & continue buttons)
        closeBtn.addEventListener("click", closeModule);
        continueBtn.addEventListener("click", closeModule);

        function closeModule() {
            module.style.display = "none";
            openBtn.style.display = "inline-block";
        }
    </script>

    <!-- -------------------- HEAT CLICK FUNCTIONALITY -------------------- -->
    <script>
        const image = document.getElementById("heatImage");
        const popup = document.getElementById("heatPopup");
        const cancelBtn = document.getElementById("cancelHeat");
        const submitBtn = document.getElementById("submitHeat");

        let selectedFeeling = null; // Stores emoji feeling
        let clickX = 0;
        let clickY = 0;

        // Show popup at clicked image position
        image.addEventListener("click", (e) => {
            const rect = image.getBoundingClientRect();

            clickX = e.clientX - rect.left;
            clickY = e.clientY - rect.top;

            const offset = 180; // distance below the click
            popup.style.left = clickX + "px";
            popup.style.top = (clickY + offset) + "px"; // move popup below click
            popup.style.display = "block";
        });


        // Emoji selection logic
        document.querySelectorAll(".emoji-row span").forEach(emoji => {
            emoji.addEventListener("click", () => {
                document.querySelectorAll(".emoji-row span")
                    .forEach(e => e.classList.remove("active"));

                emoji.classList.add("active");
                selectedFeeling = emoji.dataset.feel;
            });
        });

        // Cancel popup
        cancelBtn.addEventListener("click", () => {
            popup.style.display = "none";
            popup.querySelector("textarea").value = "";
        });

        // Submit heat point
        submitBtn.addEventListener("click", () => {
            const comment = popup.querySelector("textarea").value.trim();

            // Validation
            if (!selectedFeeling) {
                alert("Please select how you feel (emoji).");
                return;
            }

            if (comment === "") {
                alert("Please explain why.");
                return;
            }

            // Choose dot color
            let color = "green";
            if (selectedFeeling === "neutral") color = "yellow";
            if (selectedFeeling === "sad") color = "red";

            // Create dot
            const dot = document.createElement("div");
            dot.className = "heat-dot";
            dot.style.left = clickX + "px";
            dot.style.top = clickY + "px";
            dot.style.backgroundColor = color;

            // Add dot to image
            document.querySelector(".image-wrapper").appendChild(dot);

            // Log data
            console.log({
                x: clickX,
                y: clickY,
                feeling: selectedFeeling,
                comment: comment
            });

            // Reset popup
            popup.style.display = "none";
            popup.querySelector("textarea").value = "";
            selectedFeeling = null;

            document.querySelectorAll(".emoji-row span")
                .forEach(e => e.classList.remove("active"));
        });
    </script>

</body>

</html>